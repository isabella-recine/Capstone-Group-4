CREATE OR REPLACE VIEW CAPSTONE_DE.GROUP_4.TAXI_ACCIDENT_CAUSE_RANKED_VW AS(
    SELECT BOROUGH, VEHICLE_TYPE_CODE_1 AS VEHICLE_TYPE_CODE,
           CONTRIBUTING_FACTOR_VEHICLE_1 AS ACCIDENT_TYPE,
           RANK() OVER(PARTITION BY BOROUGH ORDER BY ACCIDENT_TYPE) AS RANK
    FROM CAPSTONE_DE.GROUP_4.ACCIDENT_DATA
    WHERE VEHICLE_TYPE_CODE_1 = 'TAXI'
    GROUP BY BOROUGH, VEHICLE_TYPE_CODE_1, ACCIDENT_TYPE);
